# SelfModifyingAgent โ ุงูุฏููู ุงูุงุญุชุฑุงูู ุงูุดุงูู

---

## ๐ ูุง ูู SelfModifyingAgentุ

ุทุจูุฉ ุชุทููุฑ ุฐุงุชู ุขููุฉ ูุฐููุฉ ูุฃู ูููุฐุฌ ุฃู ูุธุงู Python.  
ุชููููู ูู ุงูุชุฑุงุญ ูุชุทุจูู ุชุนุฏููุงุช (parameters ุฃู ููุฏ ุฃู ูุญุฏุงุช)ุ ุงุฎุชุจุงุฑูุง ุขูููุงุ ุชูููู ุงููุฎุงุทุฑุ ุงููุฑุงุฌุนุฉ ุงูุงูุชุฑุงุถูุฉุ ุฏูุฌูุง ูู Gitุ ุงูุชุฑุงุฌุน ุงูุฐุงุชูุ ูุฑุงูุจุฉ ุตุญุฉ ุงููุธุงูุ ูุชูููุฏ ูุซุงุฆู ุชููุงุฆูุฉ โ ูู ุฐูู ุจุฏูู ุชุฏุฎู ุจุดุฑู ูุจุงุดุฑ.

---

## ๐งฉ ุงูููููุงุช ุงูุฃุณุงุณูุฉ โ Overview

- **ุงูุชุฑุงุญ ุชุนุฏูู/ูุญุฏุฉ ุฌุฏูุฏุฉ:** (`propose_update`, `propose_new_module`)
- **ููุงููุงุช ูุชุนุฏุฏุฉ:** (`approve_update`)
- **Sandbox ูุชุนุฏุฏ:** ุงุฎุชุจุงุฑ ุขูู ููู ุชุนุฏูู (ูุฑุฏูุ ุฏูุนุงุชุ ุฃู Quantum).
- **ุชุญููู ุงูุงุนุชูุงุฏูุงุช:** ูุดู ุงูุนูุงูุงุช ูุงูุชุฃุซูุฑุงุช ุฏุงุฎู ุงูููุฏ.
- **ุชูููู ุงููุฎุงุทุฑ ุงูุฐูู:** ุชูููู ุชููุงุฆู ููู ุชุนุฏูู ุจูุงุก ุนูู ุชุงุฑูุฎู ูุณุฌูู.
- **ุฏูุฑุฉ ุชุญุณูู ุชููุงุฆู (self-retry):** ุฅุฐุง ูุดู ุงูุชุนุฏููุ ูุญุงูู ุชุญุณููู ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู.
- **ูุฑุงุฌุนุฉ ุงูุชุฑุงุถูุฉ:** ุชุญููู ุฐูู ููู ุชุนุฏูู (heuristic + LLM-ready).
- **ุฃูุงู ุชูุจุคู:** ูุญุต ุฃูุงู ูุชูุฏูุ ุฌุงูุฒ ููุฑุจุท ูุน LLM.
- **ุชูููุฏ ูุซุงุฆู ุชููุงุฆู:** ููุงุฑูุฉ ูุจู/ุจุนุฏ ุงูุชุบููุฑ ูุชูููุฏ doc ุชููุงุฆู.
- **Dashboard hooks:** ุชุตุฏูุฑ snapshot ูุญุงูุฉ ุงููุธุงู ูุฃู ููุญุฉ ูุฑุงูุจุฉ.
- **ุนุฒู sandbox ูุชูุฏู:** snapshotุ limits ููููุงุฑุฏุ ูุงุจู ููุชูุณุน ููุธุงู ูููุงุช ูููู.
- **ุชุฑุงุฌุน ุฐุงุชู:** rollback ูุฃู ุชุนุฏูู ุนูุฏ ุงูุชุดุงู ุฎุทุฃ ูุชุฃุฎุฑ.
- **Telemetry ุฎุตูุตู:** ุชุชุจุน ุงูุฃุฏุงุก ูุน ุญูุงูุฉ ุงูุฎุตูุตูุฉ.
- **ุชูุงูู Git ุงุญุชุฑุงูู:** ุฏุนู branch/commit/push ูุน ูุญุงูุงุฉ PR.
- **ุณุฌู ูุฑูุฒู:** ูู ุฎุทูุฉ ูุญููุธุฉ ูุน version/hash/timestamp.
- **ูุงุจููุฉ ุงูุชุทููุฑ:** ูู ูุญุฏุฉ ูุงุจูุฉ ููุชุฎุตูุต ุฃู ุงูุชุจุฏูู.

---

## โก ุฏูุฑุฉ ุญูุงุฉ ุงูุชุนุฏูู (Full Lifecycle)

```mermaid
graph TD
    propose --> approve
    approve --> dependency_analysis
    dependency_analysis --> risk_scoring
    risk_scoring --> peer_review
    peer_review --> sandbox
    sandbox --> retry_self_improve
    retry_self_improve --> git_commit
    git_commit --> autodoc
    autodoc --> apply
    apply --> audit
    audit --> dashboard
    dashboard --> self_healing
    self_healing --> telemetry
    telemetry --> notify
    notify --> rollback
```

**ุดุฑุญ ุงูุฎุทูุงุช:**

1. **propose:** ุงูุชุฑุงุญ ุชุนุฏูู ุฃู ุฅุถุงูุฉ ูุญุฏุฉ.
2. **approve:** ุฌูุน ุงูููุงููุงุช ุงููุทููุจุฉ.
3. **dependency_analysis:** ุชุญููู ุชุฃุซูุฑ ุงูุชุนุฏูู ุนูู ุจููุฉ ุงููุธุงู.
4. **risk_scoring:** ุชูููู ุฐูู ููุฎุงุทุฑ ุงูุชุนุฏูู.
5. **peer_review:** ูุฑุงุฌุนุฉ ุงูุชุฑุงุถูุฉ (Meta-Agent).
6. **sandbox:** ุชุฌุฑุจุฉ ุขููุฉ ููุชุนุฏูู (ูุฑุฏู/ุฏูุนุฉ/quantum).
7. **retry_self_improve:** ูุญุงููุฉ ุชุญุณูู ุงูุชุนุฏูู ุชููุงุฆููุง ูู ุญุงู ุงููุดู (LLM Feedback).
8. **git_commit:** ุฅูุดุงุก ูุฑุน/commit/PR ุชุฌุฑูุจู.
9. **autodoc:** ุชูููุฏ ูุซุงุฆู ุชููุงุฆูุฉ (diff/summary).
10. **apply:** ุชุทุจูู ุงูุชุนุฏูู ูุนูููุง.
11. **audit:** ุชุณุฌูู ูู ุฎุทูุฉ ูู ุงูุณุฌู ุงููุฑูุฒู.
12. **dashboard:** ุชุญุฏูุซ ููุญุฉ ุงูุชุญูู ุฃู ููู snapshot.
13. **self_healing:** ูุฑุงูุจุฉ ุตุญุฉ ุงููุธุงู ูุงูุชุฑุงุฌุน ุงูุฐุงุชู ูู ุญุงู ุธููุฑ ูุดุงูู.
14. **telemetry:** ุฅุฑุณุงู ููุงููุณ ุฃุฏุงุก ูุน ุญูุงูุฉ ุงูุฎุตูุตูุฉ.
15. **notify:** ุฅุดุนุงุฑ ุงููุณุชุฎุฏู ุฃู ุงููุธุงู ุจุฃู ุญุฏุซ ููู.
16. **rollback:** ุงูุชุฑุงุฌุน ุงูุฐุงุชู ุนูุฏ ุงูุญุงุฌุฉ.

---

## ๐๏ธ ุฃูุซูุฉ ุนูููุฉ โ Practical Examples

### 1๏ธโฃ ุชุนุฏูู ูุนููุฉ ุฏุงุฎููุฉ ุจุฃูุงู ูุฐูุงุก

```python
from services.model.self_modifying_agent import SelfModifyingAgent

class Model:
    lr = 0.1

model = Model()
agent = SelfModifyingAgent(model, repo_path=".", enable_dashboard=True, enable_dp_telemetry=True)

# ุงูุชุฑุงุญ ุชุนุฏูู ูุชุทูุจ ููุงููุชูู
update_id = agent.propose_update("lr", 0.15, reason="ุชุญุณูู ุงูุฃุฏุงุก", required_approvals=2)

agent.approve_update(update_id)
agent.approve_update(update_id)

# ุชุฌุฑุจุฉ ุฏูุนุฉ ุชุนุฏููุงุช (batch) ูุชุทุจูู ุงูุฃูุถู:
agent.apply_best_pending_batch()

# ูุฑุงุฌุนุฉ ุงูุณุฌู
for change in agent.audit_trail():
    print(change)
```

---

### 2๏ธโฃ ุฅุถุงูุฉ ูุญุฏุฉ ุฌุฏูุฏุฉ ูุน ูุฑุงุฌุนุฉ ุงูุชุฑุงุถูุฉ ูุชูููู ูุฎุงุทุฑุฉ

```python
new_code = '''
class DynamicTool:
    def run(self):
        return "ุนูู ุฏููุงูููู!"
'''
code_path = "services/model/dynamic_tool.py"
update_id = agent.propose_new_module(
    code=new_code,
    code_path=code_path,
    reason="ุฅุถุงูุฉ ุฃุฏุงุฉ ุฏููุงููููุฉ ุฌุฏูุฏุฉ",
    required_approvals=2
)

agent.approve_update(update_id)
agent.approve_update(update_id)
# ุชุทุจูู ุงูุชุนุฏููุงุช ูุน self-retry ูauto-doc
agent.apply_pending_updates()
```

---

### 3๏ธโฃ ุชุฌุฑุจุฉ Quantum Sandbox (ุนุฏุฉ ูุชุบูุฑุงุช/patches ูุงุฎุชูุงุฑ ุงูุฃูุถู)

```python
mutators = [
    lambda code: code.replace("return", "print('debug'); return"),
    lambda code: code + "\n# ุชุฌุฑุจุฉ ุชุนููู ุชููุงุฆู"
]
quantum = agent.quantum_sim
results = quantum.simulate(
    code_path="services/model/dynamic_tool.py",
    base_code=new_code,
    test_cmd=["pytest", "-q"]
)
# ุงุฎุชูุงุฑ ุฃูุถู patch
best = results[0]
print("ุฃูุถู ููุฏ:", best["code"])
```

---

### 4๏ธโฃ ูุฑุงูุจุฉ ุตุญุฉ ุงููุธุงู ูุงูุชุฑุงุฌุน ุงูุฐุงุชู (Self-Healing Rollback)

```python
def health_check():
    # ูุซุงู: ุฌูุจ ูุณุจุฉ ุงูุฎุทุฃ ูู logs/metrics
    return {"error_rate": 0.04}
agent.set_self_heal(health_check, window=60, threshold=0.05)

# ุจุนุฏ ุฃู applyุ ุฅุฐุง ุฒุงุฏุช ูุณุจุฉ ุงูุฎุทุฃ ุจุนุฏ ุฏูููุฉุ ูุชู rollback ุชููุงุฆู!
```

---

## ๐ ุฃูุงู ูุชูุฏู ูุชูููู ูุฎุงุทุฑุฉ

- **adaptive_type_check:** ูุณูุญ ููุท ุจุชุญูููุงุช ุขููุฉ (numericุ str<->number)ุ ููุฑูุถ ุงูุชุญูููุงุช ุงูุจููููุฉ ุฃู ูุทูุจ ููุงููุฉ ุจุดุฑูุฉ.
- **PredictiveSecurityChecker:** ููุญุต ุงูููุฏ ุนุจุฑ heuristics ููุงุจู ููุฑุจุท ูุน LLM.
- **VirtualPeerReviewer:** ูุฑุงุฌุนุฉ ุงูุชุฑุงุถูุฉ ูุจู ุงูุชุทุจูู ููู ุชุนุฏูู (ุฎุงุตุฉ ุนุงููุฉ ุงููุฎุงุทุฑ).
- **RiskScorer:** ุชูููู ูุฎุงุทุฑุฉ ุฏููุงูููู ุจูุงุกู ุนูู ุงูุณุฌู ูุงูุฃุฏุงุก ุงูุณุงุจู.
- **code_is_safe:** ูุญุต ุงุณุชุจุงูู ูุฃู ูุญุงููุฉ ุชูููุฐ ุฃูุงูุฑ ุฎุทุฑุฉ.

---

## ๐ ูุฑุงูุจุฉ ุงูุฃุฏุงุก ูุงูุฎุตูุตูุฉ (Dashboard/Telemetry)

- **DashboardHooks:** ุชุตุฏูุฑ snapshot ูุฃู ุญุงูุฉ ุฅูู ููู JSON ุฃู push hook ูุฃู dashboard ุฎุงุฑุฌู.
- **DPTelemetry:** ุชุชุจุน ูู ููุงููุณ ุงูุฃุฏุงุก ุงูุฑุฆูุณูุฉ ูุน ุญูุงูุฉ ุงูุฎุตูุตูุฉ (Laplace noise).
- **AutoDocGenerator:** ููู ุชุนุฏููุ ุชูููุฏ ูุซููุฉ diff ูููุฎุต ุชููุงุฆู.

---

## ๐ ูุนุงููุฑ ุงููุจูู (Acceptance Criteria)

- ุฃู ุชุนุฏูู ูุฌุจ ุฃู ููุฑ ุจูุงูู ุฏูุฑุฉ ุงูุญูุงุฉ (propose โ approve โ dependency โ risk โ review โ sandbox โ retry โ git โ doc โ apply โ audit โ dashboard โ telemetry โ rollback).
- ุฑูุถ ุชููุงุฆู ูุฃู ูุญุงููุฉ ุชุนุฏูู ุญูู ุญุณุงุณ.
- sandbox ูbatch/quantum ูุฏุนููุฉ ุจุงููุงูู.
- self-retry (LLM feedback) ุนูุฏ ุงููุดู.
- rollback ุฐุงุชู ุนูุฏ ุงูุชุดุงู ูุดุงูู ุจุนุฏ ุงูุชุทุจูู.
- ุฅุดุนุงุฑุงุช ูุฃู ุญุฏุซ ููู.
- ูู ุดูุก ููุซู ูู ุงูุณุฌู ุงููุฑูุฒู.
- Telemetry ุฎุงุต ูุขูู.
- ุชูุงูู ุชุงู ูุน ุงูุฃูุธูุฉ ุงูุจุฑูุฌูุฉ ูุงูุงุฎุชุจุงุฑูุฉ.
- ูุงุจููุฉ ุงูุชุฎุตูุต ูุงูุชูุณุนุฉ ูุฃู ูุธุงู ุฐูุงุก ุงุตุทูุงุนู.

---

## ๐ง ููู ุชุฏูุฌ ูุน ุฐูุงุก ุงุตุทูุงุนู ุฃูุจุฑุ

- ูููู ุฑุจุท LLMAdapter ุจุฃู ุฎุฏูุฉ GPT/Claude/OpenSource.
- hooks ููู ูุฑุญูุฉ: (ูุจู/ุจุนุฏ sandboxุ ูุจู/ุจุนุฏ gitุ ุจุนุฏ ูู apply).
- ูู ูุญุฏุฉ ูุงุจูุฉ ููุชุจุฏูู ุฃู ุงูุชุฎุตูุต ูุฃู ุชุฌุฑุจุฉ ุจุญุซูุฉ ุฃู ุฅูุชุงุฌูุฉ ูุชูุฏูุฉ.

---

## ๐ ูุตุงุฆุญ ูุชูุฏูุฉ

- ูููุดุงุฑูุน ุงููุจูุฑุฉุ ุงุณุชุฎุฏู batch sandbox ูุชุฌุฑุจุฉ ุฏูุนุงุช ูุชุญุณูู ุงูุฃุฏุงุก.
- ุงุฑุจุท DashboardHooks ุจุฃู ูุธุงู ูุฑุงูุจุฉ ุฎุงุฑุฌู (websocket, grafana...).
- ุงุณุชุฎุฑุฌ ุจูุงูุงุช ุงูุงุนุชูุงุฏูุงุช ูุชูููู ุงููุฎุงุทุฑ ุนูุฏ ุชุฌุฑุจุฉ ุชุนุฏููุงุช ูุนูุฏุฉ.
- ูุนูู self-healing rollback ูู ุงูุฃูุธูุฉ ุงูุญุฑุฌุฉ.
- ุงุณุชุฎุฏู DPTelemetry ุฅุฐุง ูุงู ูุฑููู ููุชู ุจุงูุฎุตูุตูุฉ ุงููุตูู.

---

## ๐ ุงูุฎูุงุตุฉ

SelfModifyingAgent ุงูุขู ูู ุฃููู ุทุจูุฉ ุชุทููุฑ ุฐุงุชู ุขููุฉ ูุงุญุชุฑุงููุฉ ูุฃู ูุดุฑูุน Python/AI.  
ูุฏุนู ูู ุฏูุฑุฉ ุงูุญูุงุฉ ุงูุฐููุฉ ูุฃู ุชุญุฏูุซุ ูุน ุฃูุงู ูุดูุงููุฉ ุบูุฑ ูุณุจููุฉุ ููุงุจููุฉ ุชูุณุนุฉ ูุฃู ุจูุฆุฉ ุฐูุงุก ุงุตุทูุงุนู ุฃู ุฅูุชุงุฌ ุจุฑูุฌูุงุช.

---